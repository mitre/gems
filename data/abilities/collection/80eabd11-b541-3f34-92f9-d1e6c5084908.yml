- id: 80eabd11-b541-3f34-92f9-d1e6c5084908
  name: GEMS - Get Parameter
  description: >
    Get the value of one or more parameters. Enter a comma-separated list of parameters
    to query using the gems.parameter.names fact.
  tactic: collection
  technique_id: T0861
  technique_name: Point & Tag Identification
  executors:
  - platform: linux
    name: sh
    command: >
      ./gems-client get #{gems.device.psm} #{gems.device.addr}
      --names #{gems.parameter.names} --user #{gems.device.user} --pass #{gems.device.password}
    payloads:
    - gems-client
    timeout: 360
    parsers:
    - module: plugins.gems.app.parsers.parameter
      parserconfigs:
      - source: gems.device.addr
        edge: has_parameter
        target: gems.parameter.value
  - platform: windows
    name: psh
    command: >
      .\gems-client.exe get #{gems.device.psm} #{gems.device.addr}
      --names #{gems.parameter.names} --user #{gems.device.user} --pass #{gems.device.password}
    payloads:
    - gems-client.exe
    timeout: 360
    parsers:
    - module: plugins.gems.app.parsers.parameter
      parserconfigs:
      - source: gems.device.addr
        edge: has_parameter
        target: gems.parameter.value
  - platform: windows
    name: cmd
    command: >
      .\gems-client.exe get #{gems.device.psm} #{gems.device.addr}
      --names #{gems.parameter.names} --user #{gems.device.user} --pass #{gems.device.password}
    payloads:
    - gems-client.exe
    timeout: 360
    parsers:
    - module: plugins.gems.app.parsers.parameter
      parserconfigs:
      - source: gems.device.addr
        edge: has_parameter
        target: gems.parameter.value
  - platform: darwin
    name: sh
    command: >
      ./gems-client_darwin get #{gems.device.psm} #{gems.device.addr}
      --names #{gems.parameter.names} --user #{gems.device.user} --pass #{gems.device.password}
    payloads:
    - gems-client_darwin
    timeout: 360
    parsers:
    - module: plugins.gems.app.parsers.parameter
      parserconfigs:
      - source: gems.device.addr
        edge: has_parameter
        target: gems.parameter.value
  repeatable: true
  plugin: gems
