- id: 5cd1c580-dff7-4790-8417-0cd4e6479b72
  name: GEMS - Send Directive with Arguments
  description: >
    Send a directive with arguments. Arguments must be formatted as parameters in GEMS-ASCII
    format. Multiple parameters must be separated by the pipe character ('|').
  tactic: impair-process-control
  technique_id: T0855
  technique_name: Unauthorized Command Message
  executors:
  - platform: linux
    name: sh
    command: >
      ./gems-client directive #{gems.device.psm} #{gems.device.addr} #{gems.directive.name}
      --params #{gems.parameter.value} --user #{gems.device.user} --pass #{gems.device.password}
    payloads:
    - gems-client
    timeout: 360
  - platform: windows
    name: psh
    command: >
      .\gems-client.exe directive #{gems.device.psm} #{gems.device.addr} #{gems.directive.name}
      --params #{gems.parameter.value} --user #{gems.device.user} --pass #{gems.device.password}
    payloads:
    - gems-client.exe
    timeout: 360
  - platform: windows
    name: cmd
    command: >
      .\gems-client.exe directive #{gems.device.psm} #{gems.device.addr} #{gems.directive.name}
      --params #{gems.parameter.value} --user #{gems.device.user} --pass #{gems.device.password}
    payloads:
    - gems-client.exe
    timeout: 360
  - platform: darwin
    name: sh
    command: >
      ./gems-client_darwin directive #{gems.device.psm} #{gems.device.addr} #{gems.directive.name}
      --params #{gems.parameter.value} --user #{gems.device.user} --pass #{gems.device.password} 
    payloads:
    - gems-client_darwin
    timeout: 360
  repeatable: true
  plugin: gems
